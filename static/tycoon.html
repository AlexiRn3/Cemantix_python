<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>L'Archive - Centre de Contr√¥le</title>
    <link rel="stylesheet" href="/static/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script type="importmap">
      {
        "imports": {
          "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
          "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
        }
      }
    </script>
    <style>
        body { margin: 0; overflow: hidden; background: #000; }
        
        /* Canvas 3D en arri√®re-plan */
        #game-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        /* HUD (Interface utilisateur par dessus la 3D) */
        #ui-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            pointer-events: none; /* Laisse passer les clics vers la 3D sauf sur les boutons */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 20px;
            box-sizing: border-box;
        }

        .hud-top {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            pointer-events: auto;
        }

        .resource-counter {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            padding: 15px 30px;
            border-radius: 30px;
            border: 1px solid var(--accent);
            text-align: center;
        }

        .hud-bottom {
            pointer-events: auto;
            background: rgba(20, 20, 20, 0.9);
            border-top: 2px solid var(--secondary);
            height: 160px;
            overflow-x: auto;
            display: flex;
            align-items: center;
            padding: 0 20px;
            gap: 15px;
            /* Scroll horizontal pour les upgrades */
            white-space: nowrap;
        }

        .upgrade-card-3d {
            background: var(--surface);
            min-width: 140px;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid var(--border);
            cursor: pointer;
            transition: transform 0.2s;
            color: white;
            text-align: center;
            display: inline-block;
        }
        
        .upgrade-card-3d:hover { transform: translateY(-5px); border-color: var(--secondary); }
        .upgrade-card-3d.disabled { opacity: 0.5; filter: grayscale(1); }

        .back-btn {
            background: rgba(0,0,0,0.5);
            color: white;
            border: 1px solid white;
            padding: 10px 20px;
            cursor: pointer;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>

<canvas id="game-canvas"></canvas>

<div id="ui-layer">
    <div class="hud-top">
        <a href="/" class="back-btn">‚Üê QUITTER</a>
        
        <div class="resource-counter">
            <div style="font-size: 0.8rem; text-transform: uppercase; color: var(--text-muted);">Savoir Accumul√©</div>
            <div id="currency-display" style="font-size: 2rem; font-weight: bold; color: var(--accent);">0</div>
            <div style="font-size: 0.9rem;">+<span id="pps-display">0</span> / sec</div>
        </div>

        <button class="back-btn" onclick="openLoginModal()">üë§ Compte</button>
    </div>

    <div class="hud-bottom" id="upgrades-container">
        </div>
</div>

<div id="modal-overlay" class="modal-overlay">
    <div class="modal-box">
        <div id="modal-title" class="modal-title"></div>
        <div id="modal-content" class="modal-content"></div>
        <div class="modal-actions"><button class="btn" onclick="closeModal()">Fermer</button></div>
    </div>
</div>

<script type="module" src="/static/js/tycoon_3d.js"></script>

<script type="module">
    import { updateSessionUI, verifierPseudo } from "/static/js/session.js";
    import { openLoginModal, closeModal } from "/static/js/modal.js";
    window.openLoginModal = openLoginModal;
    window.closeModal = closeModal;
    
    document.addEventListener("DOMContentLoaded", () => {
        if(!verifierPseudo()) {
            document.getElementById('ui-layer').style.display = 'none'; // Cache l'UI si pas connect√©
        }
    });
</script>

</body>
</html>